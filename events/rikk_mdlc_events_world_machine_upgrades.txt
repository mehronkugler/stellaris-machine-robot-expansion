namespace = rikk_mdlc_wm_upgrade_events

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.110
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		add_deposit = rikk_mdlc_d_world_machine_outer_core_cooled
	}
}

country_event = {
	id = rikk_mdlc_wm_upgrade_events.120
	title = rikk_mdlc_wm_upgrade_events.120.name
	desc = rikk_mdlc_wm_upgrade_events.120.desc
	picture = GFX_evt_large_explosion
	show_sound = event_scanner
	is_triggered_only = yes
	
	trigger = {
		check_modifier_value = { modifier = rikk_mdlc_world_machine_dyson_sphere_receiver_max value < 0 }
	}
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.120.a
	}
}

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.130
	title = rikk_mdlc_wm_upgrade_events.130.name
	desc = rikk_mdlc_wm_upgrade_events.130.desc
	picture = GFX_evt_burning_city
	show_sound = event_scanner
	is_triggered_only = yes
	
	immediate = {
		owner = { set_country_flag = wm_upgrade_reinforced_planet_allowed }
	}

	option = {
		name = rikk_mdlc_wm_upgrade_events.130.a
		custom_tooltip = rikk_mdlc_wm_upgrade_events.130.a.tooltip
	}
}

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.131
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		rikk_mdlc_is_wm_planet_trigger = yes
		has_deposit = rikk_mdlc_d_world_machine_mantle_engine
		owner = { has_technology = rikk_mdlc_tech_world_machine_mantle_upgrade }
		NOT = { owner = { has_country_flag = wm_upgrade_reinforced_planet_allowed } }
	}
	
	immediate = {
		planet_event = { id = rikk_mdlc_wm_upgrade_events.130 days = 10 }
		owner = { set_country_flag = wm_upgrade_reinforced_planet_allowed }
	}
}

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.70
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		xvcv_mdlc_world_machines_output_value_calc_effect = yes
	}
}

situation_event = {
	id = rikk_mdlc_wm_upgrade_events.20
	title = rikk_mdlc_wm_upgrade_events.20.name
	desc = rikk_mdlc_wm_upgrade_events.20.desc
	picture = GFX_evt_sapient_AI
	show_sound = event_scanner
	is_triggered_only = yes
	
	trigger = { NOT = { owner = { has_country_flag = rikk_mdlc_core_core_shaddup } } }
	
	immediate = { target = { set_variable = { which = rikk_mdlc_magnetic_field_var value = 1 } } }
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.20.a
		target = { 
			add_modifier = { modifier = weak_magnetic_field mult = rikk_mdlc_magnetic_field_var }
			if = {
				limit = { has_deposit = rikk_mdlc_d_world_machine_core_tap }
				remove_deposit = rikk_mdlc_d_world_machine_core_tap
			}
		}
	}
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.20.b
		hidden_effect = { owner = { set_country_flag = rikk_mdlc_core_core_shaddup } }
		target = {
			add_modifier = { modifier = weak_magnetic_field mult = rikk_mdlc_magnetic_field_var }
			if = {
				limit = { has_deposit = rikk_mdlc_d_world_machine_core_tap }
				remove_deposit = rikk_mdlc_d_world_machine_core_tap
			}
		}
	}
}

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.21
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			while = {
				count = 10
				random_owned_pop = {
					kill_pop = yes
				}
			}
			set_planet_flag = rikk_mdlc_core_core_monster
		}
	}
}

planet_event = {
	id = rikk_mdlc_wm_upgrade_events.22
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			add_deposit = rikk_mdlc_d_world_machine_core_refuse
			set_planet_flag = rikk_mdlc_core_core_monster
		}
	}
}

situation_event = {
	id = rikk_mdlc_wm_upgrade_events.23
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		current_stage = stage_2 
	}

	immediate = {
		target = {
			change_variable = {
				which = rikk_mdlc_magnetic_field_var
				value = 0.4
			}
			add_modifier = { modifier = weak_magnetic_field mult = rikk_mdlc_magnetic_field_var }
		}
	}
}

situation_event = {
	id = rikk_mdlc_wm_upgrade_events.30
	title = rikk_mdlc_wm_upgrade_events.30.name
	desc = rikk_mdlc_wm_upgrade_events.30.desc
	picture = GFX_evt_sapient_AI
	show_sound = event_scanner
	is_triggered_only = yes
	
	trigger = { NOT = { owner = { has_country_flag = rikk_mdlc_core_core_shaddup } } }
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.30.a
	}
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.30.b
		hidden_effect = { owner = { set_country_flag = rikk_mdlc_core_core_shaddup } }
	}
}

situation_event = {
	id = rikk_mdlc_wm_upgrade_events.40
	title = rikk_mdlc_wm_upgrade_events.40.name
	desc = rikk_mdlc_wm_upgrade_events.40.desc
	picture = GFX_evt_sapient_AI
	show_sound = event_scanner
	is_triggered_only = yes
	
	trigger = { NOT = { owner = { has_country_flag = rikk_mdlc_core_core_shaddup } } }
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.40.a
		target = { remove_modifier = weak_magnetic_field }
	}
	
	option = {
		name = rikk_mdlc_wm_upgrade_events.40.b
		target = { remove_modifier = weak_magnetic_field }
		hidden_effect = { owner = { set_country_flag = rikk_mdlc_core_core_shaddup } }
	}
}
